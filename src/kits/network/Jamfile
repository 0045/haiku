SubDir HAIKU_TOP src kits network ;

UsePrivateHeaders libroot net shared ;
UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;

local services = [ FGristFiles services ] ;
SEARCH on $(services) = [ FDirName $(SUBDIR) libbind defaults ] ;

SubDirC++Flags [ FDefines _BSD_SOURCE=1 ] ;

local architectureObject ;
for architectureObject in [ MultiArchSubDirSetup ] {
	on $(architectureObject) {
		local architecture = $(TARGET_PACKAGING_ARCH) ;

		UsePrivateSystemHeaders ;

		local libnetwork = [ MultiArchDefaultGristFiles libnetwork.so ] ;
		SharedLibrary $(libnetwork) :
			init.cpp
			interfaces.cpp
			getifaddrs.cpp
			socket.cpp
			r5_compatibility.cpp
			:
			<libbind!$(architecture)>libbind.o libutil.a bsd
			[ TargetLibsupc++ ]
			;

		AddFileDataAttribute $(libnetwork) : services : string : $(services) ;
	}
}

SubInclude HAIKU_TOP src kits network libbind ;
SubInclude HAIKU_TOP src kits network libnetapi ;
