SubDir HAIKU_TOP src bin getconf ;

UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;

rule GetConfKeysGen
{
	SEARCH on $(2) = $(SEARCH_SOURCE) ;
	SEARCH on $(3) = $(SEARCH_SOURCE) ;

	Depends $(1) : $(2) $(3) ;
	MakeLocateArch $(<) ;
	GetConfKeysGen1 $(1) : $(2) $(3) ;
	LocalClean clean : $(<) ;
}

actions GetConfKeysGen1
{
	LC_ALL=C gawk -f $(2[2]) $(2[1]) > $(1)
}

GetConfKeysGen [ FGristFiles confstr.c ] : confstr.gperf : fake-gperf.awk ;
GetConfKeysGen [ FGristFiles limits.c ] : limits.gperf : fake-gperf.awk ;
GetConfKeysGen [ FGristFiles pathconf.c ] : pathconf.gperf : fake-gperf.awk ;
GetConfKeysGen [ FGristFiles progenv.c ] : progenv.gperf : fake-gperf.awk ;
GetConfKeysGen [ FGristFiles sysconf.c ] : sysconf.gperf : fake-gperf.awk ;

BinCommand getconf :
	getconf.c
	confstr.c
	limits.c
	pathconf.c
	progenv.c
	sysconf.c
	: libbsd.so
	;


